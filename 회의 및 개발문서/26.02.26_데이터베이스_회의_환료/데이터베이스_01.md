# 데이터베이스


### 애플리케이션 요구사항 분석 및 설정 (도메인 분석)
> [!NOTE]
> 데이터베이스 테이블 작성을 위한 요구사항 분석 <br>
> 2차 회의 내용을 기반으로 추가적인 수정 사항을 반영

#### 회의 내용을 토대로 한 데이터베이스 테이블 설계

- 공유 일정 테이블 생각 (추후 설명)
- 시험 일정을 어떻게 처리할지 (강의 일정으로 편입?)

- 회원 테이블 (Users)

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 회원ID | 기본 키 | ex) abcdef123 |
| 비밀번호 | X | ex) abc123!@(암호화) |
| 이메일 | X | ex) abcd@abc.def |
| 이름 | X | ex) 홍길동 |
| 전화번호 | X | ex) 010-1234-5678 |
| 생년월일 | X | ex) 2000.01.01 |
| 주소 | X | 서울특별시 강남구 |
| 우편번호 | X | ex) 10101 |
| 가입일 | X | ex) 2026.01.12 |
| 회원 구분 | X | ex) 관리자/교수/학생 등 |
| 학번/교번 (user_number) | X | ex) 202201001 |
| 학년/연차 | X | 1학년 / 2학년 / 3학년 / 4학년 |
| 학기 | X | 1학기 / 2학기 / 계절학기 |
| 회원 상태 | 외래 키 (회원 상태 테이블 참조) |  |
| 입학일/임용일 |  | YY-MM-DD  |
| 졸업일/퇴사일 |  | YY-MM-DD  |

- 회원 상태 테이블

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 회원 상태 이름 | 기본 키 | ex) 재학, 휴학, 정학, 퇴학, 졸업, 휴직, 재직, 사직 |

- 회원 상태 적용일 테이블 (기간이 종료되면 회원 상태 기록 테이블로 데이터 이동)
    - 휴학, 정학, 휴직 등의 일부 상태만 기록

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 회원 ID | 기본 키
외래 키 (회원 테이블 참조) |  |
| 적용 일자 |  | YY-MM-DD HH:MM |
| 종료 일자 |  | YY-MM-DD HH:MM |

- 회원 상태 기록 테이블 (회원 상태 적용일 테이블에서 기록이 옮겨질 테이블)

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 상태 기록 코드 | 기본 키 | 자동 생성 |
| 회원 ID | 외래 키 (회원 테이블 참조) |  |
| 회원 상태 | 외래 키 (회원 상태 테이블 참조) |  |
| 적용 일자 |  | YY-MM-DD HH:MM |
| 종료 일자 |  | YY-MM-DD HH:MM
퇴학의 경우 종료일X |

- 학부 테이블 (**facultyInfo**)

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 학부 코드 | 기본 키 | ex) ABC |
| 학부명 | X | ex) 공학 / 인문 / 사회 / 자연계 / 신학 / 보건 / 교양 |

- 학과 테이블 (Department)

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 학과 코드 | 기본 키 | ex) ABC |
| 학과명 | X | ex)  (컴공 / 정통 / 경제 / 역사 / 국문 / 경영 / 공통) |
| 학부 코드 | 외래 키(학부 테이블 참조) |  |
- 강의 테이블 (Course)
    - 같은 강의(강의 코드가 같은 과목)는 중복 수강 불가
    - 동시에 같은 강의실에 강의를 열 수 없도록 하는 조건 검사 필요
        - ex) 강의 기간 + 요일 + 시간 + 강의실이 같은 경우
    - 특정 강의는 특정 학과가 수강 불가 OR 특정 학과만 수강 가능
        - 특히 교양 과목들 (특정 학과 필수 교양 OR 교양이 특정 전공에 지나치게 유리한 경우)
        - 수강 가능한 학과가 여러개 OR 수강 불가능한 학과가 여러개 → 테이블이 하나 더 필요!
        - 필드에 화이트리스트 및 블랙리스트 필드 추가, 조건 검사
    - 교수 이름은 내부적으로 JOIN하여 회원에게 표시
    - 교수 강의실은 내부적으로 JOIN하여 회원에게 표시
        - 교수 강의실이 없는 경우(예약 시스템에 등록 X) 없음으로 표시
    - 폐강에 대한 생각 필요 (일단은 보류) → 수강 취소 후 삭제?
        - 삭제가 된 후 , 알림이 가는 방식?
        - 문자발송, 이메일 발송, 알림 등

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 강의 코드 | 기본 키 (복합 키) | ex) ABC |
| 강의 분반 (추후 이름 수정) | 기본 키 (복합 키) | ex) A / B / C / D |
| 강의명 | X | ex) 알고리즘 |
| 수강 가능 조건 | X | ex) ALL(모두 수강 가능, 디폴드 값) / A(조건 코드 테이블 참조) |
| 수강 불가 조건 | X | ex) NONE(모두 수강 가능, 디폴드 값) / ABC(ABC 학과는 수강 불가) |
| 강의 시작 날짜 | X | ex) 26.03.02 |
| 강의 종료 날짜 | X | ex) 26.07.01 |
| 강의 시간 | X | 강의 시간이 여러개인 경우 고려 필요 |
| 학부 코드 | 외래 키 (학부 테이블 참조) | ex) ABC (공학 / 인문 / 사회 / 자연계 / 신학 / 보건 / 교양) |
| 학과 코드 (전공) | 외래 키(학과 테이블 참조) | ex) ABC (컴공 / 정통 / 경제 / 역사 / 국문 / 경영 / 공통)  |
| 담당 교수 ID | 외래 키 (회원 테이블 참조) | ex) Kimchulsu123 |
| 이수 구분 |  | 필수 / 선택 (기본값 = 선택) |
| 최대 수강 인원 |  | 최소인원 (폐강) 고려
수강 최소인원 ≤ 수강 인원 ≤ 강의실 정원 |
| 현재 수강 인원 |  | 숫자 |
| 이수학점 | X | EX) 3, 2 |
| 시설 코드(강의실) | 외래 키(시설 테이블 참조) | ex) 18110 |
- 수강 조건 테이블

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 조건 코드 | 기본 키, 외래 키 (조건 코드 테이블 참조, 복합 키) | ex) A |
| 학과 코드 | 기본키, 외래 키 (학과 코드 테이블 참조, 복합 키) | ex)  학과 코드가 들어감 |
- 수강 조건 코드 테이블

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 조건 코드 | 기본 키 | ex) A |

- 시간표 테이블

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 시간표 이름 | 기본 키 | ex) 0교시, 1교시, 2교시 |
| 시작 시간 |  | HH:MM |
| 종료 시간 |  | HH:MM |

- 일정 분류 테이블
    - 일정 분류 이름을 기본 키로 할지? 기본키를 따로 둘지?(일정 코드)

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 일정 코드 | 기본 키 (고려 중) | ex) A, B, C |
| 일정 분류명 | X | ex) 전공 필수 / 전공 선택 / 교양 필수 / 교양 선택 / 개인 일정 / 시험 일정 / 학사 일정 등 |

- 공유 일정 테이블 (학사 일정 테이블)
    - 강의 / 시험 / 학사 일정(학교 축제, 수강 신청 기간 ,수강 정정 기간 등) / 보강 등 여러 사람이 공통적으로 가지고 있는 일정을 저장할 테이블
    - 기존 프로젝트에서의 일명 `여유시간`을 공유 일정 테이블로 구현할지 여부 논의
        - 따로 빼는 것이 좋아보임 → 여유 시간을 따로 계산하기로 결정!

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 공유 일정 코드 | 기본 키 | 자동 생성 |
| 강의 코드 | 외래 키 (강의 테이블 참조) | Optional(비어있는 값 허용) |
| 일정 코드 | 외래 키 (일정 분류 테이블 참조) |  |
| 시작 시간 | X | YY-MM-DD HH:MM |
| 종료 시간 | X | YY-MM-DD HH:MM |
- 수강 테이블
    - 순수 수강 정보만 담는 테이블
    - 교수들도 해당 범주에 포함 되는가. = 수강은 학생만 가능하므로 X
    - 재수강 조건 관련
        - 재수강 하기 위한 조건 + 재수강 시 받는 등급 한계 설정
            - 재수강 신청 시 현재 등급 확인
            - 재수강 완료 시 최대 등급 조건 확인
    - 수강 상태 테이블 관련 논의 필요

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 수강 코드 | 기본키 | 자동 생성 |
| 회원ID | 외래 키 (회원 테이블 참조) | 회원 ID가 학생의 ID인 경우만 데이터 삽입 허용 (수강은 학생만 가능) |
| 강의 코드 | 외래 키 (강의 테이블 참조) | UNIQUE 속성 |
| 수강연도 | X | YYYY |
| 학기 | X | EX) 1학기 / 2학기 / 계절 |
| 강의등급 | X | EX) A, A+, P, NP |
| 재수강 여부 | X | EX) Y / N |
| 수강상태 | X | EX) 미이수 / 이수중 / 이수 |
- 개인 일정 테이블
    - 회원의 개인 일정을 저장
    - 회원의 개인 일정은 공유하지 않는다고 가정!
    - 캘린더 앱을 사용하는 겸 학교 시스템을 이용하는 방식으로 생각
    - 개인 일정은 투표 여유 시간에 사용되지 않도록 함
        - 즉, 개인 일정은 철저히 개인의 일정을 확인하는 용도로만 제한

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 개인 일정 코드 | 기본 키 | 자동 생성 |
| 회원ID | 외래 키 (회원 테이블 참조) |  |
| 일정  | X |  |
| 일정 이름 | X |  |
| 일정 시작 시간 |  | YY-MM-DD HH:MM |
| 일정 종료 시간 |  | YY-MM-DD HH:MM |
- 여유 시간 테이블
    - 투표 시 같은 강의를 수강하는 인원들의 여유 시간을 표시
    - 공유 일정을 기반으로 계산 (계산 시점 : 투표 개설 시점에 계산)
        - 학사 공통 일정이 생겼을 경우의 변수
        - 같은 강의를 듣는 사람들의 시험 일정 + 보강 일정이 변수
    - 개인일정은 본인이 조율하는것
    - 학사일정과 관련된 것 → 학사 일정이 우선
    - 경조사 등의 예외 >>> 교수 이메일 / 교수 강의실 / 교수 전화번호
        - 학생과 교수가 오프라인 매체 or 온라인매체로 조정
    - 30분 단위로 계산
        - 미리 계산해놓는 방법을 고려해봐야 함
        - 새로 계산을 할 시, 삭제 or 수정 = update 사용?
        - 여러 학교에서 사용하는 시스템 가정
        - 시간표 테이블 > 학교마다 다름
        - 1:15~ 2:45 → 1:00~1:30 여유시간이X 2:30~3:00 여유시간이 X

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 여유 시간 코드 | 기본 키 | 자동 생성 |
| 강의코드 | 외래 키 (강의 테이블 참조) | UNIQUE 속성 |
| 시작 시간 |  | YYYY-MM-DD HH:MM |
| 종료 시간 |  | YYYY-MM-DD HH:MM |
| 여유 인원 |  | 숫자로 표현? |
| 여유 일정 이름 |  | 1교시 / 2교시 / 3교시 … / 7시~7시반 … 이름이 필요할지..? |

- 투표 테이블
    - 투표 코드와 시간을 복합 키로 사용할지, 투표 선택지 하위 테이블을 만들지 여부 논의
    - 시작시간, 종료 시간이 겹치는 경우에 대한 고려 필요 (겹치는 시간으로 설정 불가하도록)
    - 투표 데이터는 임시적으로 값을 저장하는 특성을 가짐
    - 투표 완료 시 마감 기능 추가
    - 재투표 기능 추가
    - 투표 선택지는 최소 1개 이상 있어야 투표 생성 가능
    - 투표 선택지 추가 / 삭제 / 투표 마감 / 투표 승인(학생 기능) 등으로 잘못된 일정 확정 방지
    - 강의실 대여 시스템이 가장 유용할 것으로 보임
        - 확정 시 강의실을 대여하는 개념?
        - 교수의 오조작으로 잘못 생성된 경우 (실수로 생성된 경우)
            - 삭제기능
            (투표명, 수업 외 시간 등등)
        - 이에 따라 시설 대여도 원치않게 신청이 이루어지는 부분들
    - 투표 선택지 1~5 : 보통 2~3개 선택지에서 고를거라는 생각
        - 투표 선택지 테이블? → 생각해보기
    - 투표 선택지 수정
    - 투표 잘못 하는경우 방지해야함
        - 한 사람이 여러번 투표 → 해결 완료 (투표 선택지 테이블)

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 투표 코드 | 기본 키 | 자동 생성 |
| 강의 코드 | 외래 키 (강의 테이블 참조) | UNIQUE 속성 (강의 분반과 묶어서) |
| 강의 분반 | 외래 키 (강의 테이블 참조) | UNIQUE 속성 (강의 코드와 묶어서) |
| 투표명 | X | ex) 중간고사, 기말고사, 보강 등 |
| 투표 상태 | X | 투표 중 / 투표 완료 / 투표 마감 등 |

- 투표 선택지 테이블
    - 투표 선택지 테이블의 시작 시간 및 종료 시간은 중복되어도 상관 없음
        - 완전히 같은 경우에만 선택지를 만들지 못하도록 설계

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 투표 선택지 코드 | 기본 키 | 자동 생성 |
| 투표 코드 | 외래 키 (투표 테이블 참조) |  |
| 투표 선택지 이름 | X | ex) 목요일 저녁 |
| 시작 시간 |  | YYYY-MM-DD HH:MM
UNIQUE 속성 (종료 시간과 묶어서) |
| 종료 시간 |  | YYYY-MM-DD HH:MM
UNIQUE 속성 (시작 시간과 묶어서) |
| 시설 코드 | 외래 키(시설 테이블 참조) |  |

- 투표 집계 테이블
    - 투표 선택지 테이블이 있으면 필요할까? → 생각해보기
        - 실수로 or 고의로 중복해서 투표하여 투표 데이터 왜곡 가능성
    - 투표자는 비공개 하되, 내부 데이터베이스에서는 투표자 ID를 저장
    - 투표 테이블 외래키를 가져와서 투표 선택지 선택 여부를 저장
    - 선택한 투표 선택지를 저장

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 투표 코드 | 복합 키
외래 키 (투표 테이블 참조) |  |
| 투표자 ID | 복합 키
외래 키 (회원 테이블 참조) | 해당 강의를 수강하고 있는지 여부 판별 필요 |
| 투표 선택지 코드 | 복합 키
외래 키 (투표 선택지 테이블 참조) | 해당 테이블에 입력된 투표선택지 코드는 해당 학생이 선택지에 ‘O’ 표시를 한 것으로 간주 |

- 시설 테이블 (강의실 테이블에서 옮김)
    - 강의실 정보 저장
        - 강의실 인원, 위치 등
    - 주로 강의, 시험, 보강에서만 사용하므로 해당 강의실 사용 여부 체크가 필요함
    - 강의실 대여 시스템? (예약)

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 시설 코드 | 기본 키 |  |
| 시설명 | X |  |
| 시설 분류 | 외래 키 (시설 분류 테이블 참조) | 교수실 |

- 시설 분류 테이블
    - 강의실 / 교수실 / 도서관 열람실 / 회의실

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 시설 분류 코드 | 기본 키 |  |
| 시설 분류명 | X | ex) 강의실 / 도서실 / 교수실 / 회의실 등 |

- 시설 예약
    - 시설 코드
    - 시설 예약을 30분 단위로 나눠서 진행
    - 시설 예약 및 취소 기능
    - 시설 사용 가능 여부를 판단해야하는 것
    - 시간을 가지고 해야되는데, 시설 테이블이나 강의 테이블에 들어가면 안됨
    - 시설 예약 시스템을 위한 테이블도 하나 만들어야함
    - 투표 시에 시설 예약 시스템 연동 → 투표시스템을 위해 만들지만 사실상 시설 예약 시스템
    - 교수는 교수실 명목으로 일정 기간 대여 한다고 가정
    - 시설 사용자는 내부적으로 아이디 사용, 사용자에게 보여지는 정보는 이름 (JOIN)
    - 5개의 필드 (표시된 필드)가 UNIQUE 속성으로 지정된다
        - 같은 시간에 같은 시설을 예약하는 것을 방지
    - 학생이 교수실 조회
        - 교수님 이름 동명이인

| 필드명 | 키 여부 | 비고 |
| --- | --- | --- |
| 시설 예약 코드 | 기본 키 | 자동생성 |
| 예약 시작일 |  | YYYY-MM-DD |
| 예약 종료일 |  | YYYY-MM-DD |
| 예약 시작 시간 |  | HH:MM |
| 예약 종료 시간 |  | HH:MM |
| 시설 분류 | 외래 키 (시설 분류 테이블) | 교수실은 교수 여부 판단 필요 |
| 사용자ID | 외래 키 (회원 테이블 참조) |  |
| 승인 여부 |  | 승인/ 거절 / 보류 등 |
| 내용(비고) |  |  |
| 시설 코드  | 외래 키(시설 테이블 참조) | 5110 |
